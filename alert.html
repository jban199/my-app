<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, interactive-widget=overlays-content">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>TAK - Siren</title>

    <!-- PWA Meta Tags -->
    <link rel="manifest" href="manifest.json">
    <link rel="icon" href="favicon.ico" sizes="any">
    <meta name="theme-color" content="#1A1A1A">

    <!-- Link to the stylesheet -->
    <link rel="stylesheet" href="styles.css">

</head>
<body>

<section id="tak-page-loader">
	<div class="tak-spinner"></div>
	<p>Loading...</p>
	
	<script>
		window.addEventListener('load', function () {
			const loader = document.getElementById('tak-page-loader');
			if (loader) {
			loader.style.display = 'none';
			}
		});
	</script>
</section>

<!-- ///////////////// -->
<!-- Siren buttons -->
<!-- ///////////////// -->

<section class="srn-container">
	<div class="srn-container-row srn-flash-options">
		<button id="srn-flash-police" class="srn-bg-button" data-bg="images/icons/srn-siren-blink.svg">
			<img src="images/icons/srn-flasher-blue-red.svg">
			<span class="label">Police</span>
			<span class="pulse-indicator"></span>
			
		</button>

		<button id="srn-flash-red" class="srn-bg-button" data-bg="images/icons/srn-red-blink.svg">
			<img src="images/icons/srn-red.svg">
			<span class="label">Red Blink</span>
			<span class="pulse-indicator"></span>
		</button>


		<button id="srn-flash-safety" class="srn-bg-button" data-bg="images/icons/srn-neon-blink.svg">
			<img src="images/icons/srn-life.svg">
			<span class="label">Safety</span>
			<span class="pulse-indicator"></span>
		</button>
	</div>

	<div class="srn-container-row srn-sound-options">
		
		<button class="srn-audio-button" data-audio="media/srn-sounds/siren-38642.mp3">
			<img src="images/icons/srn-siren.svg">
			<span class="label">Siren: 1</span>
			<span class="pulse-indicator"></span>
		</button>
		
		<button class="srn-audio-button" data-audio="media/srn-sounds/siren-police-63597.mp3">
			<img src="images/icons/srn-siren.svg">
			<span class="label">Siren: Police</span>
			<span class="pulse-indicator"></span>
		</button>
		
		<button class="srn-audio-button" data-audio="media/srn-sounds/police-operation-siren-144229.mp3">
			<img src="images/icons/srn-siren.svg">
			<span class="label">Siren: Police Operation</span>
			<span class="pulse-indicator"></span>
		</button>
		
		<button class="srn-audio-button" data-audio="media/srn-sounds/siren-a-248662.mp3">
			<img src="images/icons/srn-siren.svg">
			<span class="label">Siren: 2</span>
			<span class="pulse-indicator"></span>
		</button>
		
		<button class="srn-audio-button" data-audio="media/srn-sounds/civil-defense-siren-128262.mp3">
			<img src="images/icons/srn-siren.svg">
			<span class="label">Siren: Civil Defense</span>
			<span class="pulse-indicator"></span>
		</button>

		<button class="srn-audio-button" data-audio="media/srn-sounds/delta-7-evacuation-siren-22510.mp3">
			<img src="images/icons/srn-siren.svg">
			<span class="label">Siren: Evacuation</span>
			<span class="pulse-indicator"></span>
		</button>

		<button class="srn-audio-button" data-audio="media/srn-sounds/fire-truck-siren-29900.mp3">
			<img src="images/icons/srn-siren.svg">
			<span class="label">Siren: Fire Truck</span>
			<span class="pulse-indicator"></span>
		</button>

		<button class="srn-audio-button" data-audio="media/srn-sounds/warfare_taser_gun_005.mp3">
			<img src="images/icons/srn-electric.svg">
			<span class="label">Taser 1</span>
			<span class="pulse-indicator"></span>
		</button>

		<button class="srn-audio-button" data-audio="media/srn-sounds/warfare_taser_gun_002.mp3">
			<img src="images/icons/srn-electric.svg">
			<span class="label">Taser 2</span>
			<span class="pulse-indicator"></span>
		</button>


		<button class="srn-audio-button" data-audio="media/srn-sounds/balloon-rubbing-foley-5-184049.mp3">
			<img src="images/icons/srn-balloon.svg">
			<span class="label">Balloon</span>
			<span class="pulse-indicator"></span>
		</button>

		<button class="srn-audio-button" data-audio="media/srn-sounds/big-dog-barking-300504.mp3">
			<img src="images/icons/srn-dog.svg">
			<span class="label">Dog Bark</span>
			<span class="pulse-indicator"></span>
		</button>


		<button class="srn-audio-button" data-audio="media/srn-sounds/fox-calling-243999.mp3">
			<img src="images/icons/srn-fox.svg">
			<span class="label">Fox Cry</span>
			<span class="pulse-indicator"></span>
		</button>

		<button class="srn-audio-button" data-audio="media/srn-sounds/scary-wolf-growling-224086.mp3">
			<img src="images/icons/srn-wolf.svg">
			<span class="label">Wolf Growl</span>
			<span class="pulse-indicator"></span>
		</button>

		<button class="srn-audio-button" data-audio="media/srn-sounds/hooded-crow-cawing-217457.mp3">
			<img src="images/icons/srn-crow.svg">
			<span class="label">Crow 1</span>
			<span class="pulse-indicator"></span>
		</button>

		<button class="srn-audio-button" data-audio="media/srn-sounds/crow-bird-calling-bird-crow-sound-8908.mp3">
			<img src="images/icons/srn-crow.svg">
			<span class="label">Crow 2</span>
			<span class="pulse-indicator"></span>
		</button>

		<button class="srn-audio-button" data-audio="media/srn-sounds/crow-67929.mp3">
			<img src="images/icons/srn-crow.svg">
			<span class="label">Crow 3</span>
			<span class="pulse-indicator"></span>
		</button>

	</div>


<script>
  // --- Background Image Toggle Script ---
  let currentBg = null;

  const bgButtons = document.querySelectorAll('.srn-bg-button');

  bgButtons.forEach(button => {
    const imageUrl = button.getAttribute('data-bg');

    button.addEventListener('click', () => {
      const isActive = button.classList.contains('active-bg');

      // Reset all buttons
      bgButtons.forEach(btn => {
        btn.classList.remove('active-bg', 'no-shadow');
      });

      if (isActive) {
        // If clicking again, reset background
        document.body.style.backgroundImage = '';
        currentBg = null;
      } else {
        // Set background
        document.body.style.backgroundImage = `url('${imageUrl}')`;
        currentBg = imageUrl;
        button.classList.add('active-bg', 'no-shadow');
      }
    });
  });

// --- Audio Toggle Script ---
const audioButtons = document.querySelectorAll('.srn-audio-button');
  const audioMap = new Map();

  audioButtons.forEach(button => {
    const audioSrc = button.getAttribute('data-audio');
    const audio = new Audio(audioSrc);
    audio.loop = true;
    audioMap.set(button, audio);

    button.addEventListener('click', () => {
      const isPlaying = button.classList.contains('playing');

      // Stop all audios and reset buttons
      audioMap.forEach((a, btn) => {
        a.pause();
        a.currentTime = 0;
        btn.classList.remove('playing', 'no-shadow');
      });

      // If it wasn't already playing, play and activate
      if (!isPlaying) {
        audio.play();
        button.classList.add('playing', 'no-shadow');
      }
    });
  });
</script>

<style>
.srn-container {
	padding: 20px 10px;
    border-radius: 10px;
    display: flex;
    flex-direction: column;
    gap: 10px;
	background: transparent;
    position: fixed;
    bottom: 75px;
}

.srn-flash-options {
	display: grid;
	grid-template-columns: repeat(3, 1fr);
	gap: 5px;
}

.srn-sound-options {
	display: flex;
	flex-direction: row;
	gap: 10px;
	overflow: scroll;
	width: 95vw;
    padding: 20px 0px;
}

.srn-sound-options::before,
.srn-sound-options::after {
	content: '\3000\3000\3000\3000\3000\3000\3000\3000\3000\3000\3000\3000\3000';
}



.srn-container button {
	display: flex;
	flex-direction: row;
	gap: 5px;
	justify-content: start;
	align-items: center;
	border-radius: 30px;
	background: #ffffff10;
	border: none;
	padding: 0px 20px 0px 0px;
	font-size: 10px;
	color: var(--font1);
	box-shadow: 0px 5px 0px -2px var(--shadow1);
	position: relative;
	text-align: left;
}

.srn-container button.no-shadow {
      box-shadow: 0px 1px 0px var(--shadow1); !important;
	  transform: translateY(3px);
    }

.srn-container img{
<!--	background: #ffffff10; -->
	height: 32px;
	width: 32px;
	padding: 5px;
	border-radius: 30px;
}


.pulse-indicator {
	width: 7px;
	height: 7px;
	background-color: green;
	border-radius: 50%;
	margin-left: auto;
	opacity: 0;
	position: absolute;
	right: 3px;
	top: 3px;
	transition: opacity 0.3s ease-in-out;
}


.playing .pulse-indicator {
	opacity: 1;
	animation: pulse 1s infinite;
}


.active-bg .pulse-indicator {
  opacity: 1;
  animation: pulse 1s infinite;
}

@keyframes pulse {
0% {
  transform: scale(1);
  box-shadow: 0 0 0 0 rgba(0, 255, 0, 0.5);
}
70% {
  transform: scale(1.2);
  box-shadow: 0 0 0 10px rgba(0, 255, 0, 0);
}
100% {
  transform: scale(1);
  box-shadow: 0 0 0 0 rgba(0, 255, 0, 0);
}
}

</style>

</section>


<!-- ///////////////// -->
<!-- Footer Spacer -->
<!-- ///////////////// -->
<div class="footerSpacer">
</div>




<!-- ///////////////// -->
<!-- Bottom Menu -->
<!-- ///////////////// -->
<section>
<!-- SBM Trigger -->
<svg id="SBM-Icon" height="24px" viewBox="0 -960 960 960" width="24px" fill="#ffffff">
    <path d="M86-191v-126h788v126H86Zm0-226v-126h788v126H86Zm0-226v-126h788v126H86Z"/>
</svg>

<!-- SBM container (empty, the content is injected here) -->
<div id="SBM-container"></div>
</section>


<script>
window.onload = function() {		
    // Load SBM
    fetch('sbm.html')
        .then(response => response.text())
        .then(data => {
            const sidebarContainer = document.getElementById('SBM-container');
            sidebarContainer.innerHTML = data;

            // Make sure sidebar is hidden after load
            const overlaySBM = document.getElementById("SBM-section");
            if (overlaySBM) {
                overlaySBM.style.transform = "translateY(100%)";
            }

            // Reattach event listeners after the SBM is loaded
            const closeButton = document.getElementById("closeSBM");
            if (closeButton) {
                closeButton.addEventListener("click", closeSBM);
            }

            // Get reference to the icon that triggers the sidebar opening
            const SBMIcon = document.getElementById("SBM-Icon");

            // Function to open the sidebar
            function openSBM() {
                if (overlaySBM) {
                    overlaySBM.style.transform = "translateY(0)";
                }
            }

            // Function to close the sidebar
            function closeSBM() {
                if (overlaySBM) {
                    overlaySBM.style.transform = "translateY(100%)";
                }
            }

            // Event listener for opening the SBM when the icon is clicked
            if (SBMIcon) {
                SBMIcon.addEventListener("click", openSBM);
            }
        })
        .catch(error => {
            console.error("Error loading SBM:", error);
        });
};
</script>


<!-- ///////////////// -->
<!-- User Selected Accent Color -->
<!-- ///////////////// -->
<style id="theme-accent-style">
  :root {
	--accent1: #FD7E14; /* Default fallback accent */
  }
</style>
<script>
	(function theme_applyAccentFromStorage() {
	const savedAccent = localStorage.getItem('theme_accent');
	const accentStyle = document.getElementById('theme-accent-style');

	if (savedAccent && accentStyle) {
	  accentStyle.textContent = `:root { --accent1: ${savedAccent}; }`;
	}
	})();
</script>



<!-- ///////////////// -->
<!-- Theme Toggle -->
<!-- ///////////////// -->
<section>
<button id="theme-toggle">
    <!-- Default dark icon (SVG) -->
    <svg id="dark-icon" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f">
      <path d="M480-280q-83 0-141.5-58.5T280-480q0-83 58.5-141.5T480-680q83 0 141.5 58.5T680-480q0 83-58.5 141.5T480-280ZM200-440H40v-80h160v80Zm720 0H760v-80h160v80ZM440-760v-160h80v160h-80Zm0 720v-160h80v160h-80ZM256-650l-101-97 57-59 96 100-52 56Zm492 496-97-101 53-55 101 97-57 59Zm-98-550 97-101 59 57-100 96-56-52ZM154-212l101-97 55 53-97 101-59-57Z"/>
    </svg>

    <!-- Light Icon (hidden by default) -->
    <svg id="light-icon" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f" style="display: none;">
      <path d="M480-120q-150 0-255-105T120-480q0-150 105-255t255-105q14 0 27.5 1t26.5 3q-41 29-65.5 75.5T444-660q0 90 63 153t153 63q55 0 101-24.5t75-65.5q2 13 3 26.5t1 27.5q0 150-105 255T480-120Z"/>
    </svg>
</button>
</section>

<!-- ///////////////// -->
<!-- Set Theme - Based on Local Storage -->
<!-- ///////////////// -->
<script>
  // Wait for the DOM to be fully loaded before running the script
  document.addEventListener("DOMContentLoaded", function() {
    const themeLink = document.createElement("link");
    themeLink.rel = "stylesheet";
    themeLink.id = "theme-link";
    
    // Check if a theme preference is saved in localStorage
    const savedTheme = localStorage.getItem("theme");

    if (savedTheme === "dark") {
      themeLink.href = "dark-theme.css";  // If dark theme is saved, load dark-theme.css
    } else if (savedTheme === "light") {
      themeLink.href = "light-theme.css"; // If light theme is saved, load light-theme.css
    } else {
      themeLink.href = "dark-theme.css";  // Default to dark theme if no preference is saved
      localStorage.setItem('theme', 'dark');  // Save preference
    }

    // Append the theme <link> tag to the <head> of the document
    document.head.appendChild(themeLink);

    // Initialize icons based on saved theme preference
    const darkIcon = document.getElementById('dark-icon');
    const lightIcon = document.getElementById('light-icon');

    if (savedTheme === "dark") {
      lightIcon.style.display = 'none';
      darkIcon.style.display = 'block';
    } else {
      lightIcon.style.display = 'block';
      darkIcon.style.display = 'none';
    }

    // Toggle theme when button is clicked
    const themeToggleButton = document.getElementById('theme-toggle');

    themeToggleButton.addEventListener('click', () => {
      const currentTheme = themeLink.href.includes('dark-theme.css') ? 'dark' : 'light';
      if (currentTheme === 'dark') {
        themeLink.href = 'light-theme.css';  // Switch to light theme
        localStorage.setItem('theme', 'light');  // Save preference
        lightIcon.style.display = 'block';  // Show light icon
        darkIcon.style.display = 'none';   // Hide dark icon
      } else {
        themeLink.href = 'dark-theme.css';   // Switch to dark theme
        localStorage.setItem('theme', 'dark');  // Save preference
        lightIcon.style.display = 'none';   // Hide light icon
        darkIcon.style.display = 'block';   // Show dark icon
      }
    });
  });
</script>

<!-- ///////////////// -->
<!-- Fullscreen Toggle -->
<!-- ///////////////// -->
<section>
  <button id="fullscreen-toggle" class="fullscreen-button">
  <!-- Icon for entering fullscreen (initially displayed) -->
  <svg id="fullscreen-enter-icon" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f">
    <path d="M86-86v-260h126v134h134v126H86Zm529 0v-126h133v-134h126v260H615ZM86-615v-259h260v126H212v133H86Zm662 0v-133H615v-126h259v259H748Z"/>
  </svg>

  <!-- Icon for exiting fullscreen (hidden initially) -->
  <svg id="fullscreen-exit-icon" height="24px" viewBox="0 -960 960 960" width="24px" fill="#1f1f1f" style="display: none;">
    <path d="M220-86v-134H86v-126h260v260H220Zm395 0v-260h259v126H741v134H615ZM86-615v-126h134v-133h126v259H86Zm529 0v-259h126v133h133v126H615Z"/>
  </svg>
</button>
</section>
<script>
  // Fullscreen Toggle Logic
const fullscreenButton = document.getElementById('fullscreen-toggle');
fullscreenButton.addEventListener('click', () => {
  if (!document.fullscreenElement) {
    document.documentElement.requestFullscreen();
    document.getElementById('fullscreen-enter-icon').style.display = 'none';
    document.getElementById('fullscreen-exit-icon').style.display = 'block';
  } else {
    if (document.exitFullscreen) {
      document.exitFullscreen();
      document.getElementById('fullscreen-enter-icon').style.display = 'block';
      document.getElementById('fullscreen-exit-icon').style.display = 'none';
    }
  }
});

</script>


<!-- ///////////////// -->
<!-- Prevent Right Click Context Menu -->
<!-- ///////////////// -->
<script>
  // Prevent the context menu from appearing on right-click
  document.addEventListener('contextmenu', function(event) {
	event.preventDefault(); // Prevent the context menu from appearing
  });
</script>


<!-- ///////////////// -->
<!-- Capacitor Functions -->
<!-- ///////////////// -->
<script type="module" src="capacitorFunctions.js"></script>


</body>
</html>
